<div class="container">
  <h1>Login</h1>
  <form method="post" id="loginForm" action="">
    <label for="username">Username:</label>
    <input type="text" id="username" name="username" required>

    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>

    <!-- Call the login function when the button is clicked -->
    <button type="button" onclick="login()">Login</button>
  </form>
</div>

<!-- Include the Axios library -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
async function login() {
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;

  try {
  const res = await axios.post('/login', { username, password });
  const token = res.data.token;

  if (token) {
    // Save the token in localStorage for future use
    localStorage.setItem('token', token);

    // Set up an interceptor to include the token in headers for all requests
    axios.interceptors.request.use(config => {
      const storedToken = localStorage.getItem('token');
      if (storedToken) {
        config.headers.Authorization = `Bearer ${storedToken}`;
      }
      return config;
    });
  } else {
    console.error('Login failed: No token received');
  }
} catch (error) {
  console.error('Login failed:', error.response.data.message);
}

}
</script>