<table>
  <thead>
    <tr>
      <th>STT</th>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <!-- Initial rows for KyNangKT -->
    <tr class="KyNang KyNangKT">
      <th contenteditable="true">1</th>
      <td contenteditable="true">Value 1</td>
      <td contenteditable="true">Value 2</td>
      <td><button onclick="deleteRow(this)">Delete</button></td>
    </tr>
    <tr class="KyNang KyNangKT">
      <th contenteditable="true">2</th>
      <td contenteditable="true">Value 3</td>
      <td contenteditable="true">Value 4</td>
      <td><button onclick="deleteRow(this)">Delete</button></td>
    </tr>
    <!-- End of initial rows for KyNangKT -->

    <!-- Initial rows for KyNangTD -->
    <tr class="KyNang KyNangTD">
      <th contenteditable="true">3</th>
      <td contenteditable="true">Value 5</td>
      <td contenteditable="true">Value 6</td>
      <td><button onclick="deleteRow(this)">Delete</button></td>
    </tr>
    <!-- End of initial rows for KyNangTD -->

    <!-- Initial rows for KyNangKN -->
    <tr class="KyNang KyNangKN">
      <th contenteditable="true">4</th>
      <td contenteditable="true">Value 7</td>
      <td contenteditable="true">Value 8</td>
      <td><button onclick="deleteRow(this)">Delete</button></td>
    </tr>
    <!-- End of initial rows for KyNangKN -->
  </tbody>
</table>

<button onclick="addNewRow('KyNangKT')">Thêm dòng mới KyNangKT</button>
<button onclick="addNewRow('KyNangTD')">Thêm dòng mới KyNangTD</button>
<button onclick="addNewRow('KyNangKN')">Thêm dòng mới KyNangKN</button>
<button onclick="deleteFocusedRow()">Xóa Hàng Đang Tập Trung</button>

<script>
function UpdateSTTskill() {
  var kyNangElements = document.querySelectorAll('.KyNang');

  kyNangElements.forEach((kyNangElement, index) => {
    var thElements = kyNangElement.querySelectorAll('th');

    thElements.forEach((thElement, thIndex) => {
      thElement.textContent = index * thElements.length + thIndex + 1;

      // Thêm sự kiện click vào th để xóa hàng
      thElement.onclick = function() {
        deleteRow(thElement.closest('tr'));
      };
    });
  });
}

function addNewRow(kyNangType) {
  var tableBody = document.getElementById('tableBody');
  var newRow = document.createElement('tr');
  newRow.className = `KyNang ${kyNangType}`;
  
  var sttCell = document.createElement('th');
  sttCell.textContent = '-';
  
  var cell1 = document.createElement('td');
  cell1.textContent = 'New Value 1';

  var cell2 = document.createElement('td');
  cell2.textContent = 'New Value 2';

  var deleteButtonCell = document.createElement('td');
  var deleteButton = document.createElement('button');
  deleteButton.textContent = 'Delete';
  deleteButton.onclick = function() {
    deleteRow(newRow);
  };
  deleteButtonCell.appendChild(deleteButton);

  newRow.appendChild(sttCell);
  newRow.appendChild(cell1);
  newRow.appendChild(cell2);
  newRow.appendChild(deleteButtonCell);

  // Tìm vị trí để chèn mới
  var referenceRow = document.getElementsByClassName(kyNangType)[0];
  referenceRow.parentNode.insertBefore(newRow, referenceRow.nextSibling);

  UpdateSTTskill();
}

function deleteRow(row) {
  row.remove();
  UpdateSTTskill();
}

function deleteFocusedRow() {
  var focusedTh = document.querySelector('th.focus');
  if (focusedTh) {
    deleteRow(focusedTh.closest('tr'));
  }
}

UpdateSTTskill(); // Cập nhật số thứ tự khi trang được tải
</script>